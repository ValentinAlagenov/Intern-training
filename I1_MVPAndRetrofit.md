# Weather Report Revisited

You will build the previous app in a totally new way. Take a good look at the [TODO app](https://github.com/googlesamples/android-architecture/tree/todo-mvp/) built using the Model-View-Presenter architectural pattern. You need to separete the logic in the following components:

## Repository
This is the __"Model"__ part of MVP. It's the source of data builds as a [facade](https://en.wikipedia.org/wiki/Facade_pattern) which hides the details of obtaining the data - network/database/caches etc. This pattern is widely used regardless of the app architecture (MVP/MVVM/MVI/VIPER/...) so it's an (the) important thing to remember from this app. 
You will need two sources of data - database (using Room) and network. You should also have a local cache and do network requests only if the cache is not valid. For example if the data extracted from the database is more than 15 minutes old. For the network calls you will use the awesome library [retrofit](https://square.github.io/retrofit/). It automagically creates the REST API requests for you and parses the JSON responses back to Java models (using a Gson/Moshi/... adapter). Also supports XML and protobuffers if you ever need them. Unfortunately you won't use it with it's full power and will just use the callbacks API (it's the default one in the tutorial). To make the problem worse (or more interesting, depends on the point of view) - don't do compound API requests for all the cities. Do single requests for each one. 

## View
For the View/Presenter part use a contract interface (see the TODO sample app) with clearly defined responsibilities for each module. For example (let's think you have to load some files from the internet) the methods for the View should be in the form of `showFiles(List<Model> models)` which only shows the list of files in a RecyclerView and the methods for the presenter should be in the form of "void loadFiles()" which internally does the heavy lifting of obtaining the models from a remote source. For the View implementation we usually use fragments.

## Presenter
This is the module responsible for the "business logic" part of the app. More precisely - it obtains the data and combines it using the business rules. Then prompts the View to display the visual representation of the data.

## Unit tests
Read about [testing](https://developer.android.com/training/testing/) on Android, especially unit tests. Good testing coverage is extremely important for long-living apps. If you don't go heavy on tests you will go heavy on bugs. Tests don't guarantee that your code is bugs free. But they can prove a new bug has occured when they fail. Also they make you think more about the code you write - have you covered all edge cases, all paths of execution? And they are an indicator of smelly code - it's a very very hard task to write unit tests for crappy spaghetti code. You need clean maintainable code to write unit tests for and you need unit tests to ensure it stays that way. There are even development disciplines like TDD ([Test Driven Development](https://en.wikipedia.org/wiki/Test-driven_development)) where tests are written before the actual code. Add some actual tests in the project. You can plagiarize from the TODO app.

## More screens!
You can experiment with adding additional details screens. For example you can show tabs showing "Current weather" / "1 day forecast" / "3 days forecast" and so on. For this it will be a good idea to use the [ViewPager/PagerAdapter/ActionBar](https://developer.android.com/training/implementing-navigation/lateral) combo to implement [tabs](https://developer.android.com/training/design-navigation/descendant-lateral#tabs) & swipe navigation. Just keep in mind that each forecast "subscreen" that's shown should be used as a View with it's own Presenter. Also take a look at the [Material Design tabs page](https://material.io/design/components/tabs.html#). Material Design is a "design language" by Google which, roughly speaking, explains how different widgets should be used (both position/geometry and interaction-wise) in order to accomplish pleasing results. 